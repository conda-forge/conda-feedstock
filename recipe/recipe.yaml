context:
  name: conda
  version: "24.9.2"
# Running pytest requires the inclusion of test files which baloons
# the size of the package; values can be "yes" or "no"
# {% set run_pytest = "no" %}

package:
  name: conda
  version: ${{ version }}

source:
  url: https://github.com/conda/${{ name }}/releases/download/${{ version }}/${{ name }}-${{ version }}.tar.gz
  sha256: 0dcccbdaab96232dfee4471ca7ea7bbcacdcdf99d161cbb61bd7e92074fa7fcb

build:
  number: 0
  script: ${{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv && ${{ PYTHON }} -m conda init --install

requirements:
  build:
    - if: build_platform != target_platform
      then:
        - python
        - cross-python_{{ target_platform }}
    - if: win
      then:
        - m2-filesystem
        - m2-bash
        - m2-base
  host:
    - python
    - pip
    - hatchling >=1.12.2
    - hatch-vcs >=0.2.0
    # for `conda init` in build/script above
    - boltons >=23.0.0
    - menuinst >=2
    - platformdirs >=3.10.0
    - requests >=2.28.0,<3
    - ruamel.yaml >=0.11.14,<0.19
    - tqdm >=4
  run:
    - archspec >=0.2.3
    - boltons >=23.0.0
    - charset-normalizer
    - conda-libmamba-solver >=23.11.0
    - conda-package-handling >=2.2.0
    - distro >=1.5.0
    - frozendict >=2.4.2
    - jsonpatch >=1.32
    - menuinst >=2
    - packaging >=23.0
    - platformdirs >=3.10.0
    - pluggy >=1.0.0
    - pycosat >=0.6.3
    - python
    - requests >=2.28.0,<3
    - ruamel.yaml >=0.11.14,<0.19
    - setuptools >=60.0.0
    - tqdm >=4
    - zstandard >=0.19.0
    # include truststore when python >=3.10
    - ${{ "truststore >=0.8.0" if match(python, ">=3.10") }}

  run_constraints:
    - conda-build >=24.3
    - conda-content-trust >=0.1.1
    - conda-env >=2.6

tests:
  - script:
      - if: unix
        then:
          - sh ./run_test.sh
        else:
          - call run_test.bat
    files:
      source:
        - tests/
        - setup.cfg
      recipe:
        - if: win
          then:
            - run_test.bat
            - test_runner.bat
            - commands_to_test.bat
          else:
            - run_test.sh
            - test_runner.sh
            - commands_to_test.sh
    requirements:
      run:
        - mock
        - pytest
        - pexpect
        - responses
        - if: win
          then:
            - m2-filesystem
            - m2-bash
            - m2-base
  - python:
      imports:
        - conda
        - conda_env
  - downstream: conda-smithy

about:
  homepage: https://conda.io
  license: BSD-3-Clause
  license_file: LICENSE
  summary: OS-agnostic, system-level binary package and environment manager.
  description: |
    Conda is an open source package management system and environment
    management system for installing multiple versions of software packages
    and their dependencies and switching easily between them. It works on
    Linux, OS X and Windows, and was created for Python programs but can
    package and distribute any software.
  documentation: https://docs.conda.io/projects/conda/en/stable/
  repository: https://github.com/conda/conda

extra:
  recipe-maintainers:
    - dbast
    - isuruf
    - jakirkham
    - jezdez
    - kenodegard
    - mbargull
    - ocefpaf
    - beeankha
